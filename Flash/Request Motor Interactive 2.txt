SELECT 
	T1.IDSOLICITUD,
	T1.FECHAREGISTRO,
	T17.DIRECCIONCOMERCIAL,
	T17.GLOSA,
	T23.LEAFNODENAME,
	T25.TOPESCUPOINTERMEDIO1,
	T25.TOPESCUPOINTERMEDIO2,
	T25.TOPESCUPOINTERMEDIO3,
	T25.TOPESCUPOINTERMEDIO4,
	T25.TOPESCUPOINTERMEDIO5,
	T25.TOPESCUPORECOMENDADO,
-- De aqui para abajo --
	T1.CUPOPREAPROBADO,
	T1.FLAGPREAPROBADO,
	T1.NUMBER1,
	T1.NUMBER2,
	T1.NUMBER4,
	T1.STRING1,
	T2.MONTOMORAONLINE,
	T2.MONTOPROTESTOONLINE,
	T2.NUMMORAONLINE,
	T2.NUMPROTESTOONLINE,
	T3.CUENTAADICIONAL,
	T3.SCOREADICIONAL,
	T3.SITUACIONCTAADICIONAL,
	T3.STATUSTARJETACUENTA,
	T4.CUPOLINEA1,
	T4.CUPOLINEA2CONSUMO,
	T4.DIASMORARENEGOCIAR,
	T4.ESTADODELACUENTA,
	T4.EXCUENTACASTIGADA,
	CASE WHEN LENGTH(TRIM(SUBSTR(T4.FECHASALDOMAXIMO ,1,8))) = 8 THEN to_char(TO_DATE(T4.FECHASALDOMAXIMO ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHASALDOMAXIMO,
	CASE WHEN LENGTH(TRIM(SUBSTR(T4.FECHAULTRENEGOCIACION ,1,8))) = 8 THEN to_char(TO_DATE(T4.FECHAULTRENEGOCIACION ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHAULTRENEGOCIACION,
	T4.HABITODEPAGO,
	T4.PRODUCTOACTIVO,
	T4.PRODUCTO,
	T4.RENTA,
	T4.RENTACONFIRMADA,
	T4.SALDOMAXIMO,
	T4.SUBPRODUCTO,
	T4.TOTALDEUDAAVANCE,
	T4.TOTALDEUDALINEA1,
	T4.TOTALDEUDALINEACCONSUMO,
	T5.APERTURAINMEDIATA,
	T5.ORIGENSOLICITUD,
	T5.PROMOTOR,
	T5.SUCURSALAPERTURA,
	T6.ANIOINGRESOCARRERA,
	T6.ANIOQUECURSA,
	T6.ANIOVEHICULO,
	T6.ANTIGUEDADDOMICILIO,
	T6.ANTIGUEDADVIVIENDA,
	T6.BANCOCTACTE,
	T6.BANCOTARJETACREDITO,
	T6.CALIDADVIVIENDA,
	T6.CARGOUOCUPACIONDELSOLICITANTE,
	T6.CODCOMUNA,
	T6.CODREGION,
	T6.CODIGOHABITACIONAL,
	T6.DURACIONCARRERA,
	T6.ESTADOCARNETIDENTIDAD,
	T6.ESTADOCIVIL,
	CASE WHEN LENGTH(TRIM(SUBSTR(T6.FECHADEINGRESOALTRABAJO ,1,8))) = 8 THEN to_char(TO_DATE(T6.FECHADEINGRESOALTRABAJO ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHADEINGRESOALTRABAJO,
	CASE WHEN LENGTH(TRIM(SUBSTR(T6.FECHADENACIMIENTO ,1,8))) = 8 THEN to_char(TO_DATE(T6.FECHADENACIMIENTO ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHADENACIMIENTO,
	T6.FUNCIONARIO,
	T6.GIROOACTIVIDADDELAEMPRESA,
	T6.NACIONALIDAD,
	T6.NIVELESTUDIOS,
	T6.NROCARGAS,
	T6.RENTA,
	T6.SEXO,
	T6.TAMANIOEMPRESA,
	T6.TARJETACOMERCIAL1,
	T6.TARJETACOMERCIAL2,
	T6.TIPOAPERTURA,
	T6.TIPODEVIVIENDA,
	T8.CONFIRMACIONRENTAAVAL,
	T8.DIASMORAAVAL,
	T8.HABITOPAGOAVAL,
	T8.MARCASITIENEAVAL,
	T8.MONTOFIANZA,
	T8.RENTAAVAL,
	T8.TIENECUENTAENCMR,
	T9.BLOQUEOBASESEXTERNAS,
	T9.BLOQUEOCONSULTAS,
	T9.BLOQUEOMANUALSUSPENSION,
	T9.BLOQUEOMORA,
	T9.BLOQUEOMORA90,
	T9.BLOQUEOMORAMUYGRAVE,
	T9.BLOQUEOMORASODIMAC,
	T9.BLOQUEOOPERATIVIDAD,
	CASE WHEN LENGTH(TRIM(SUBSTR(T9.FECHAULTIMOESTDELCONTRA ,1,8))) = 8 THEN to_char(TO_DATE(T9.FECHAULTIMOESTDELCONTRA ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHAULTIMOESTDELCONTRA,
	T9.FFCTABLOQUEO,
	T9.OTROSBLOQUEOS,
	CASE WHEN LENGTH(TRIM(SUBSTR(T10.FECHAOBSERVACION1 ,1,8))) = 8 THEN to_char(TO_DATE(T10.FECHAOBSERVACION1 ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHAOBSERVACION1,
	CASE WHEN LENGTH(TRIM(SUBSTR(T10.FECHAOBSERVACION2 ,1,8))) = 8 THEN to_char(TO_DATE(T10.FECHAOBSERVACION2 ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHAOBSERVACION2,
	CASE WHEN LENGTH(TRIM(SUBSTR(T10.FECHAOBSERVACION3 ,1,8))) = 8 THEN to_char(TO_DATE(T10.FECHAOBSERVACION3 ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHAOBSERVACION3,
	T10.POSEEOBSERVACION3,
	T10.POSEEOBSERVACION1,
	T10.POSEEOBSERVACION2,
	T11.MARCAFIRMAAUTORIZAPREVIRED,
	T11.PERIODO1,
	T11.PERIODO10,
	T11.PERIODO11,
	T11.PERIODO12,
	T11.PERIODO2,
	T11.PERIODO3,
	T11.PERIODO4,
	T11.PERIODO5,
	T11.REMUNERACION1,
	T11.REMUNERACION10,
	T11.REMUNERACION11,
	T11.REMUNERACION12,
	T11.REMUNERACION2,
	T11.REMUNERACION3,
	T11.REMUNERACION4,
	T11.REMUNERACION5,
	T11.REMUNERACION6,
	T11.REMUNERACION7,
	T11.REMUNERACION8,
	T11.REMUNERACION9,
	T12.SUBPRODUCTO,
	CASE WHEN LENGTH(TRIM(SUBSTR(T13.DETALLE1FECHAPROTESTO ,1,8))) = 8 THEN to_char(TO_DATE(T13.DETALLE1FECHAPROTESTO ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END DETALLE1FECHAPROTESTO,
	CASE WHEN LENGTH(TRIM(SUBSTR(T13.DETALLE1FECHAVENCIMIENTO ,1,8))) = 8 THEN to_char(TO_DATE(T13.DETALLE1FECHAVENCIMIENTO ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END DETALLE1FECHAVENCIMIENTO,
	T13.DETALLE1LOCALIDAD,
	T13.DETALLE1MONTOPESOS,
	T13.DETALLE1MOTIVO,
	T13.DETALLE1TIPOCREDITO,
	T13.DETALLE1TIPODEUDA,
	T13.DETALLE1TIPODOCUMENTO,
	T13.DISTR12M24MPERIODODOCUMENTOS,
	T13.TOTALDOCUMENTOS,
	T14.ANUALACTUAL,
	T14.ANUALANTERIOR,
	T14.OPERACIONESACTUAL,
	T14.OPERACIONESANTERIOR,
	T14.USDACTUAL,
	T14.USDANTERIOR,
	T15.USDANTERIOR,
	CASE WHEN LENGTH(TRIM(SUBSTR(T16.FECHARECIENTE ,1,8))) = 8 THEN to_char(TO_DATE(T16.FECHARECIENTE ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHARECIENTE,
	CASE WHEN LENGTH(TRIM(SUBSTR(T16.BOLETINLABORALFECHARECIENTE ,1,8))) = 8 THEN to_char(TO_DATE(T16.BOLETINLABORALFECHARECIENTE ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END BOLETINLABORALFECHARECIENTE,
	T16.DEFUNCION,
	T16.ESTADOCEDULA,
	CASE WHEN LENGTH(TRIM(SUBSTR(T16.FECHACI ,1,8))) = 8 THEN to_char(TO_DATE(T16.FECHACI ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHACI,
	CASE WHEN LENGTH(TRIM(SUBSTR(T16.FECHADEFUNCION ,1,8))) = 8 THEN to_char(TO_DATE(T16.FECHADEFUNCION ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHADEFUNCION,
	T16.MOTIVOESTADOCI,
	CASE WHEN LENGTH(TRIM(SUBSTR(T16.QUIEBRAFECHARECIENTE ,1,8))) = 8 THEN to_char(TO_DATE(T16.QUIEBRAFECHARECIENTE ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END QUIEBRAFECHARECIENTE,
	T17.NRODIRECCIONESINFORMADAS,
	T18.APELLIDOMATERNO,
	T18.APELLIDOPATERNO,
	T18.CODIGOAREA1,
	T18.CODIGOAREA2,
	T18.DIRECCION,
	T18.DIRECCIONCALLE,
	T18.DIRECCIONCIUDAD,
	T18.DIRECCIONNUMERO,
	T18.DIRECCIONREGION,
	T18.DIRECCIONRESTO,
	T18.EDAD,
	T18.EMAIL,
	CASE WHEN LENGTH(TRIM(SUBSTR(T18.FECHACIVIL ,1,8))) = 8 THEN to_char(TO_DATE(T18.FECHACIVIL ,'dd-mm-yyyy'),'yyyymmdd') ELSE NULL END FECHACIVIL,
	T18.INFOCONYUGE,
	T18.NOMBRECOMPLETO,
	T18.NOMBRES,
	T18.NRODIRECCIONESPARTICULARES,
	T18.TELEFONO1,
	T18.TELEFONO2,
	T18.TIPO,
	T20.CANTIDADTELEFONOSFIJOS,
	T20.MONTOTOTALUF,
	T20.SCORE,
	T20.SCOREGSE

FROM TB_MRRES_INPUTANTECEDENTE T1
    LEFT JOIN TB_MRRES_ANTECEDENTESBURO T2 ON T1.IDSOLICITUD = T2.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T2.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_ANTCOMOADICIONAL T3 ON T1.IDSOLICITUD = T3.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T3.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_ANTCOMOCLIENTEOTRACTA T4 ON T1.IDSOLICITUD = T4.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T4.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_ANTSOLICITUD T5 ON T1.IDSOLICITUD = T5.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T5.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_ANTPARTICULARES T6 ON T1.IDSOLICITUD = T6.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T6.FECHAREGISTRO AS TIMESTAMP) 
    --JOIN TB_MRRES_ANTBUROMASIVO T7 ON T1.IDSOLICITUD = T7.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T7.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_CODEUDOR T8 ON T1.IDSOLICITUD = T8.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T8.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_ESTADOSBLOQUEO T9 ON T1.IDSOLICITUD = T9.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T9.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_OBSERVACIONES T10 ON T1.IDSOLICITUD = T10.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T10.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_PREVIRED T11 ON T1.IDSOLICITUD = T11.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T11.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_PRODUCTO T12 ON T1.IDSOLICITUD = T12.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T12.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONANTBURO T13 ON T1.IDSOLICITUD = T13.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T13.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONCOMEXEXPORT T14 ON T1.IDSOLICITUD = T14.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T14.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONCOMEXIMPORT T15 ON T1.IDSOLICITUD = T15.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T15.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONCONTROL T16 ON T1.IDSOLICITUD = T16.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T16.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONLABORALES T17 ON T1.IDSOLICITUD = T17.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T17.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONPARTICULAR T18 ON T1.IDSOLICITUD = T18.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T18.FECHAREGISTRO AS TIMESTAMP) 
    --JOIN TB_MRRES_TRANSUNIONPROPIEDADES T19 ON T1.IDSOLICITUD = T19.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T19.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_TRANSUNIONSCORE T20 ON T1.IDSOLICITUD = T20.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T20.FECHAREGISTRO AS TIMESTAMP) 
    --JOIN TB_MRRES_CONTROL T21 ON T1.IDSOLICITUD = T21.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T21.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_AUDITORIACALCULO T22 ON T1.IDSOLICITUD = T22.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T22.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_AUDITORIAEVALUACION T23 ON T1.IDSOLICITUD = T23.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T23.FECHAREGISTRO AS TIMESTAMP) 
    --JOIN TB_MRRES_AUDITORIASCORECARDORI T24 ON T1.IDSOLICITUD = T24.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T24.FECHAREGISTRO AS TIMESTAMP) 
    LEFT JOIN TB_MRRES_RSLTDCALCULO T25 ON T1.IDSOLICITUD = T25.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T25.FECHAREGISTRO AS TIMESTAMP) 
    --JOIN TB_MRRES_RSLTDEVALUACION T26 ON T1.IDSOLICITUD = T26.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T26.FECHAREGISTRO AS TIMESTAMP) 
    --JOIN TB_MRRES_RSLTDSCORE T27 ON T1.IDSOLICITUD = T27.IDSOLICITUD AND CAST(T1.FECHAREGISTRO AS TIMESTAMP) = CAST(T27.FECHAREGISTRO AS TIMESTAMP) 
/*--*/
WHERE 
	T1.idsolicitud IN (
'302082945','302084379','302084488','302084552','302084580','302084570','302085801','302085817','302083534','302083378','302083595','302083729','302083691','302083777','302083750','302084125','302084185','302084192','302085637','302085674','302086399')
--    T1.IDSOLICITUD <> '190490' 
--    AND T1.FECHAREGISTRO >= '30/09/22'
--    AND T17.GLOSA <> 'Rechazado'
--    AND T22.FINALESLEAFNODENAME like '01 Fin Aper EL%'
order by T1.idsolicitud
;
